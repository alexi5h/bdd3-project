DROP PROCEDURE IF EXISTS PA_PAGO_PROFESOR;
DELIMITER &&
CREATE PROCEDURE PA_PAGO_PROFESOR ()
BEGIN 
UPDATE ESTADISTICAS ES SET ES.PAGO_A_PROFESOR= (SELECT BD.VALOR FROM BANCO_DEPOSITO BD
INNER JOIN BANCO BA ON BA.ID=BD.BANCO_ID
INNER JOIN PERSONA PE ON PE.ID=BA.PERSONA_ID
INNER JOIN CURSO_EDICION CE ON CE.ID=BD.CURSO_EDICION_ID
INNER JOIN CURSO CU ON CU.ID=CE.CURSO_ID 
WHERE CU.NOMBRE=ES.NOMBRE_CURSO AND CE.NRO_EDICION=ES.NRO_INSTANCIA)
WHERE ES.PAGO_A_PROFESOR=0;
END
&&
DELIMITER ;
CALL PA_PAGO_PROFESOR ();

SELECT BD.VALOR FROM BANCO_DEPOSITO BD
INNER JOIN BANCO BA ON BA.ID=BD.BANCO_ID
INNER JOIN PERSONA PE ON PE.ID=BA.PERSONA_ID
INNER JOIN CURSO_EDICION CE ON CE.ID=BD.CURSO_EDICION_ID
INNER JOIN CURSO CU ON CU.ID=CE.CURSO_ID 
WHERE CU.NOMBRE="IT Essentials" AND CE.NRO_EDICION=1
